trigger:
  - master

pool:
  vmImage: 'ubuntu-latest'

steps:
- task: NodeTool@0
  displayName: Node install
  inputs:
    versionSpec: '10.x'

- script: 'npm ci'
  displayName: 'npm install'

- script: 'npm run bundle'
  displayName: 'build and bundle'

- script: 'npm run ci-test'
  displayName: 'test'

- task: PublishTestResults@2
  condition: succeededOrFailed()
  inputs:
    testRunner: JUnit
    testResultsFiles: '**/junit.xml'

- task: PublishCodeCoverageResults@1
  inputs:
    codeCoverageTool: Cobertura
    summaryFileLocation: '**/*coverage.xml'
    reportDirectory: '**/coverage'

- script: 'npm run lint'
  displayName: 'lint'
